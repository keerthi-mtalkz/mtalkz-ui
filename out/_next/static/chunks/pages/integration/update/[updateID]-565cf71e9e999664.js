(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4375],{65602:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/integration/update/[updateID]",function(){return a(30607)}])},14101:function(e,t,a){"use strict";var n=a(85893);t.Z=function(e){var t=e.title,a=e.subtitle;return(0,n.jsxs)("div",{className:"flex flex-col py-4 mb-4",children:[(0,n.jsx)("h1",{className:"text-lg text-default font-bold font-poppins",children:t}),(0,n.jsx)("h2",{className:"text-sm text-secondary",children:a})]})}},30607:function(e,t,a){"use strict";a.r(t);var n=a(47568),l=a(828),s=a(29815),i=a(20414),r=a(85893),c=a(67294),u=a(12596),o=a(14101),d=a(64298),h=a(34120),p=a(11163),m=a(30882),x=a(94379),f=a(52486),g=a(59936),v=a(9591),b=a(47426);t.default=(0,h.X)((function(){var e=(0,p.useRouter)(),t=e.query.updateID,a=(0,c.useState)({}),h=a[0],j=a[1],N=(0,c.useState)(void 0),w=N[0],k=N[1],_=(0,c.useState)(!1),y=_[0],S=_[1],E=(0,c.useState)(!1),I=E[0],q=E[1],T=(0,l.Z)(c.useState([]),2),A=T[0],D=T[1],Z=(0,l.Z)(c.useState([]),2),C=Z[0],P=Z[1],z=(0,c.useState)([]),U=z[0],R=z[1],L=(0,c.useState)([]),B=L[0],O=L[1],H=[188,13],X=function(e){console.log("The tag at index "+e+" was clicked")},F=function(){var e=(0,n.Z)((function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return e=localStorage.getItem("token"),[4,m.ax.get("/organizations",{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){R(null===e||void 0===e?void 0:e.data)})).catch((function(e){console.error("get /organizations error",e)}))];case 1:return t.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),G=null===U||void 0===U?void 0:U.map((function(e){return{label:e.name,value:e.id}})),M=function(){var e=(0,n.Z)((function(){var e;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return e=localStorage.getItem("token"),[4,m.ax.get("/integrations/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){j(e.data.integration),q(1===e.data.integration.requires_approval),S(1===e.data.integration.requires_access);var t=[],a=[];e.data.integration.tags.map((function(e){t.push({id:e,text:e})})),D(t),e.data.integration.param_names.map((function(e){a.push({id:e,text:e})})),P(a);var n=[];e.data.organizations.map((function(e){n.push({label:e.name,value:e.id})})),O((0,s.Z)(n)),F()})).catch((function(e){k({type:"error",err:e}),console.error("get /integration error",e)}))];case 1:a.sent(),a.label=2;case 2:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){M()}),[]);var V=(0,d.cI)(),W=V.register,J=V.handleSubmit,K=(V.watch,V.errors);return(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(o.Z,{title:"UPDATE INTEGRATION",subtitle:""}),"success"===(null===w||void 0===w?void 0:w.type)&&(0,r.jsx)("div",{className:"flex flex-wrap w-full",children:(0,r.jsx)("div",{className:"p-2",children:x.fn.success("Updated integration successfully","Success")})}),"error"===(null===w||void 0===w?void 0:w.type)&&(0,r.jsx)("div",{className:"flex flex-wrap w-full",children:(0,r.jsx)("div",{className:"p-2",children:x.fn.error(K,"Error")})}),(0,r.jsx)("div",{className:"flex flex-wrap ",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("form",{onSubmit:J((function(a){a.requires_access=I,a.requires_approval=y;var n=A.map((function(e){return e.id})),l=C.map((function(e){return e.id})),s=B.map((function(e){return e.value}));a.tags=n,a.param_names=l,a.access_granted_to=s;var i=localStorage.getItem("token");m.ax.put("/integrations/".concat(t),a,{headers:{Authorization:"Bearer ".concat(i)}}).then((function(t){j(t.data),k({type:"success"}),e.push("/integration")})).catch((function(t){k({type:"error",message:t.response.data.message}),setTimeout((function(){k(void 0),e.push("/integration")}),1e3)}))})),className:"flex flex-col text-sm mb-4 lg:w-1/3",children:[(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Name"}),(0,r.jsx)("input",{name:"name",type:"text",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integartion name",required:!0,value:h.name})]})}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Slug"}),(0,r.jsx)("input",{name:"slug",type:"text",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integration Slug",required:!0,maxLength:255,pattern:"[a-z0-9\\-]+",value:h.slug})]})}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Channel Slug"}),(0,r.jsx)("input",{name:"channel_slug",type:"text",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integration Channel Slug ",required:!0,maxLength:255,pattern:"[a-z0-9\\-]+",value:h.channel_slug})]})}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Icon Url"}),(0,r.jsx)("input",{name:"icon_url",type:"url",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integration Icon URL ",required:!0,value:h.icon_url})]})}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Description"}),(0,r.jsx)("input",{name:"description",type:"text",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integration Description ",required:!0,value:h.description})]})}),(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("span",{className:"text-default",children:"Tags"}),(0,r.jsx)(f.V,{tags:A,delimiters:H,handleDelete:function(e){D(A.filter((function(t,a){return a!==e})))},handleAddition:function(e){D((0,s.Z)(A).concat([e]))},handleDrag:function(e,t,a){var n=A.slice();n.splice(t,1),n.splice(a,0,e),D(n)},handleTagClick:X,inputFieldPosition:"bottom",autocomplete:!0})]}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Api Url"}),(0,r.jsx)("input",{name:"api_url",type:"url",ref:W({required:!0}),className:"form-input mt-1 text-xs block w-full bg-white",placeholder:"Enter Integration Api URL ",required:!0,value:h.api_url})]})}),(0,r.jsx)("div",{className:"w-full mb-4",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-default",children:"Http Method"}),(0,r.jsx)("select",{name:"http_method",ref:W(),className:"form-select block w-full mt-1 text-xs",children:b.W.map((function(e){return(0,r.jsx)("option",{value:e.value,children:e.label})}))})]})}),(0,r.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,r.jsx)("span",{className:"text-default",children:"Parameters"}),(0,r.jsx)(f.V,{tags:C,delimiters:H,handleDelete:function(e){P(C.filter((function(t,a){return a!==e})))},handleAddition:function(e){P((0,s.Z)(C).concat([e]))},handleDrag:function(e,t,a){var n=C.slice();n.splice(t,1),n.splice(a,0,e),P(n)},handleTagClick:X,inputFieldPosition:"bottom",autocomplete:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-default",children:"Requires Approval"}),(0,r.jsx)(g.default,{onChange:function(){return S(!y)},checked:y,handleDiameter:24,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-default",children:"Requires Access"}),(0,r.jsx)(g.default,{onChange:function(){return q(!I)},checked:I,handleDiameter:24,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch"})]}),I&&(0,r.jsx)("div",{style:{width:"300px"},children:(0,r.jsx)(v.ZP,{options:G,placeholder:"Select organizations ...",isMulti:!0,onChange:function(e){O((0,s.Z)(e))},value:B})}),(0,r.jsx)("div",{className:"w-full",style:{marginTop:"10px"},children:(0,r.jsx)("input",{type:"submit",className:"btn btn-default btn-block btn-indigo ",value:"Submit"})})]})})})]})}))},47426:function(e,t,a){"use strict";a.d(t,{W:function(){return n}});a(50196).ZP.create({baseURL:"https://api.mtalkz.cloud/api",withCredentials:!0,headers:{"Content-type":"application/json",Accept:"application/json"}});var n=[{value:"get",label:"GET"},{value:"post",label:"POST"},{value:"put",label:"PUT"},{value:"delete",label:"DELETE"},{value:"head",label:"HEAD"},{value:"patch",label:"PATCH"}]}},function(e){e.O(0,[5367,196,9350,4298,442,5288,7106,9774,2888,179],(function(){return t=65602,e(e.s=t);var t}));var t=e.O();_N_E=t}]);